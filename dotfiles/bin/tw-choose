#!/usr/bin/env python3
import json
import random
import subprocess
import sys

tasks_proc = subprocess.run(["task", "export", "ready"], capture_output=True)
tasks = json.loads(tasks_proc.stdout.decode('utf-8'))

total_urgency = sum(task["urgency"] for task in tasks)

skip_urgency = random.random() * total_urgency

for task in tasks:
    skip_urgency -= task["urgency"]
    if skip_urgency <= 0:
        subprocess.run(["task", task["uuid"]])
        sys.exit(0)
